1 rem screensaver2 poke 53280,0 : rem border black3 poke 53281,0 : rem background black4 poke 646,5 : rem text color green5 print chr$(147) : rem clear screen9 let debug=010 let s=1024: rem start of scr mem11 let chr=8112 dim v(1000): rem scr location visit13 dim move(4):rem no move yet14 let loc=int(rnd(1)*1000)16 let count=020 rem if debug then input a$26 let dir=int(rnd(1)*4+1)30 if dir=1 then gosub 1000:rem up31 if dir=2 then gosub 1050:rem down32 if dir=3 then gosub 1100:rem left33 if dir=4 then gosub 1150:rem right35 if debug then gosub 200038 if mo(1) and mo(2) and mo(3) and mo(4) then clr:goto 540 if count=1000 then clr:goto 5100 rem next i105 goto 20110 end1000 rem function up1010 if loc-39<=0 then move(1)=1:return1015 if v(loc-40)=1 then move(1)=1:return1016 loc=loc-401017 let v(loc)=11019 poke s+loc,chr:count=count+11030 move(1)=01040 return1050 rem function down1060 if loc+40>=1000 then move(2)=1:return1065 if v(loc+40)=1 then move(2)=1:return1066 loc=loc+401067 let v(loc)=11069 poke s+loc,chr:count=count+11080 move(2)=01090 return1100 rem function left1110 if loc/40=int(loc/40)then move(3)=1:return1115 if v(loc-1)=1 then move(3)=1:return1116 loc=loc-11117 let v(loc)=11119 poke s+loc,chr:count=count+11130 move(3)=01140 return1150 rem function right1160 if (loc+1)/40=int((loc+1)/40)then move(4)=1:return1165 if v(loc+1)=1 then move(4)=1:return1166 loc=loc+11167 let v(loc)=11169 poke s+loc,chr:count=count+11180 move(4)=01190 return2000 rem debug function2002 poke 646,1:rem text color white2005 poke 211,1: rem column2010 poke 214,1: rem row2015 sys 65520: rem kernal plot2017 rem location on screen2018 dp=loc+100002020 dp$=right$(str$(dp),4)2021 print "loc:";dp$;tab(1);2027 rem counter for visited cells2028 dp=count+100002029 dp$=right$(str$(dp),4)2031 print " count:";dp$;tab(1);2040 print " dir:";2050 if dir=1 then print "up   ";2051 if dir=2 then print "down ";2052 if dir=3 then print "left ";2053 if dir=4 then print "right";2055 poke 646,5:rem text color green2060 return